import json
import godville_stat_functions as gsf

# –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ —Ñ–∏–Ω–∏—à–∞
path_old = 'old.json'
path_new = 'new.json'

# –æ—Ç–∫—Ä—ã–≤–∞–µ–º –∏ –≤—ã–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª—ã —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
json_open_old = open(path_old, 'r', encoding='utf-8')
json_open_new = open(path_new, 'r', encoding='utf-8')
json_old = json_open_old.read()
json_new = json_open_new.read()
json_open_old.close()
json_open_new.close()

# —Ñ–æ—Ä–º–∏—Ä—É–µ–º –¥–∞—Ç–∞—Å–µ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
try:
    data_old = json.loads(json_old)['data']
except KeyError:
    data_old = json.loads(json_old)
try:
    data_new = json.loads(json_new)['data']
except KeyError:
    data_new = json.loads(json_new)


# —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –±–æ–≥–æ–≤
god_list_old = list(data_old.keys())  # —Å–ø–∏—Å–æ–∫ –±–æ–≥–æ–≤ –∏–∑ –Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
god_list_new = list(data_new.keys())  # —Å–ø–∏—Å–æ–∫ –±–æ–≥–æ–≤ –∏–∑ –∫–æ–Ω—Ü–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
god_list_actual = sorted(list(set(god_list_old) & set(god_list_new)))  # —Å–ø–∏—Å–æ–∫ –±–æ–≥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ –æ–±–æ–∏—Ö —Å–ø–∏—Å–∫–∞—Ö
god_leaved = sorted(list(set(god_list_old).difference(set(god_list_new))))  # —É—à–µ–¥—à–∏–µ –±–æ–≥–∏
god_entered = sorted(list(set(god_list_new).difference(set(god_list_old))))  # –ø—Ä–∏—à–µ–¥—à–∏–µ –±–æ–≥–∏

# –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
new_level_list_all, new_level_list_worthy = {}, {}  # —Å–ø–∏—Å–∫–∏ –±–æ–≥–æ–≤ —Å –Ω–æ–≤—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ (–≤—Å–µ –∏ –∫–∞—Ä–¥–∏–Ω–∞–ª+)
new_t_level_list = {}  # —Å–ø–∏—Å–æ–∫ –±–æ–≥–æ–≤ —Å –Ω–æ–≤—ã–º–∏ —Ç–æ—Ä–≥–æ–≤—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏
clan_position_change = {}  # –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–Ω–≥–∞ –≤ –≥–∏–ª—å–¥–∏–∏
bricks_change = {}  # –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ —Å–æ–±—Ä–∞–Ω–Ω—ã–º –∫–∏—Ä–ø–∏—á–∞–º
wood_change, savings_change = {}, {}  # –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ —Å–æ–±—Ä–∞–Ω–Ω—ã–º –±—Ä—ë–≤–Ω–∞–º –∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –ø–µ–Ω—Å–∏–∏
words_change = {}  # –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ —Å–æ–±—Ä–∞–Ω–Ω—ã–º —Å–ª–æ–≤–∞–º
fm_change = {}  # –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ —Ç–≤–∞—Ä—è–º
fight_change = {}  # –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ –±–æ—è–º (—Ä–∞–∑–Ω–∏—Ü–∞ –ø–æ–±–µ–¥ –∏ –ø–æ—Ä–∞–∂–µ–Ω–∏–π)
new_temple, new_shop, new_lab = [], [], []  # —Å–ø–∏—Å–∫–∏ –±–æ–≥–æ–≤ —Å –Ω–æ–≤—ã–º–∏ —Ö—Ä–∞–º–∞–º–∏/–∫–æ–≤—á–µ–≥–∞–º–∏/–ª–∞–≤–∫–∞–º–∏/–ª–∞–±–∞–º–∏
new_arks, new_bosses = {}, {}  # –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –±–æ–≥–∞–º —Å –Ω–æ–≤—ã–º –±–æ—Å—Å–æ–º
pet_change_level_all, pet_change_level_worthy = {}, {}  # —Å–ø–∏—Å–∫–∏ –±–æ–≥–æ–≤ —Å –Ω–æ–≤—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ —É –ø–µ—Ç–æ–≤ (–≤—Å–µ –∏ –∫–∞—Ä–¥–∏–Ω–∞–ª+)
# —Å–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–∏—Ç–æ–º—Ü–µ–≤ - –ø–æ—Ç–µ—Ä—è –ø–∏—Ç–æ–º—Ü–∞, –ø–æ—Ç–µ—Ä—è —É—Ä–æ–≤–Ω—è, –Ω–æ–≤—ã–π –ø–∏—Ç–æ–º–µ—Ü
pet_change_status = {'–ì–µ—Ä–æ–π –æ—Å—Ç–∞–ª—Å—è –±–µ–∑ –ø–∏—Ç–æ–º—Ü–∞': [],
                     '–ü–∏—Ç–æ–º–µ—Ü –≥–µ—Ä–æ—è –æ—Å—Ç–∞–ª—Å—è –±–µ–∑ —É—Ä–æ–≤–Ω—è': [],
                     '–ì–µ—Ä–æ–π –∑–∞–≤—ë–ª –Ω–æ–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞': []}

# —Å–ø–∏—Å–æ–∫ –∑–≤–∞–Ω–∏–π –Ω–∏–∂–µ –∫–∞—Ä–¥–∏–Ω–∞–ª–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
clan_positions_unworthy = ['—Ñ–∞–Ω–∞—Ç', '—Ä–µ–∫—Ä—É—Ç', '—Å—Ç–∞–∂—ë—Ä', '–∞–¥–µ–ø—Ç', '–º–∞—Å—Ç–µ—Ä', '–º–∞–≥–∏—Å—Ç—Ä', '—Å–æ–≤–µ—Ç–Ω–∏–∫', '–≥—Ä–∞–Ω–¥–º–∞—Å—Ç–µ—Ä']

# —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –ø–æ –≤—Å–µ–º –ø–æ–∑–∏—Ü–∏—è–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
for god in god_list_actual:
    # –æ–±–Ω–æ–≤–ª—è–µ–º —Å–ª–æ–≤–∞—Ä–∏ —Å —É—Ä–æ–≤–Ω—è–º–∏ –≥–µ—Ä–æ–µ–≤
    gsf.update_level_list(data_new, data_old, god, new_level_list_worthy, new_level_list_all)
    # —É—Ä–æ–≤–Ω–∏ —Ç–æ—Ä–≥–æ–≤—Ü–∞
    gsf.update_trade_level_list(data_new, data_old, god, new_t_level_list)
    # –ø–æ–∑–∏—Ü–∏—è –≤ –≥–∏–ª—å–¥–∏–∏
    gsf.update_clan_position_list(data_new, data_old, god, clan_position_change)
    # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –∫–∏—Ä–ø–∏—á–µ–π –∏ –Ω–æ–≤—ã–µ —Ö—Ä–∞–º—ã
    gsf.update_brickers_and_temples(data_new, data_old, god, bricks_change, new_temple)
    # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –±—Ä—ë–≤–µ–Ω –∏ –Ω–æ–≤—ã–µ –∫–æ–≤—á–µ–≥–∏
    gsf.update_wooders_and_arks(data_new, data_old, god, wood_change, new_arks)
    # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –ø–µ–Ω—Å–∏–∏ –∏ –Ω–æ–≤—ã–µ –ª–∞–≤–∫–∏
    gsf.update_savers_and_shops(data_new, data_old, god, savings_change, new_shop)
    # –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö —Ç–≤–∞—Ä–µ–π (—Å–∞–º—Ü–æ–≤ –∏ —Å–∞–º–æ–∫) –∏ –Ω–æ–≤—ã–µ –ª–∞–±—ã
    gsf.update_fm_and_labs(data_new, data_old, god, fm_change, new_lab)
    # –Ω–æ–≤—ã–µ –±–æ—Å—Å—ã
    gsf.update_bosses(data_new, data_old, god, new_bosses)
    # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤ –≤ –∫–Ω–∏–≥—É
    gsf.update_writers(data_new, data_old, god, words_change)
    # –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ —Å—á—ë—Ç—á–∏–∫–µ –¥—É—ç–ª–µ–π
    gsf.update_fighters(data_new, data_old, god, fight_change)
    # –ø–∏—Ç–æ–º—Ü—ã
    gsf.update_petters(data_new, data_old, god, pet_change_level_worthy, pet_change_level_all, pet_change_status)

# —Å–æ—Ä—Ç–∏—Ä—É–µ–º –≤—Å–µ —Å–ø–∏—Å–∫–∏
god_leaved = sorted(god_leaved)
god_entered = sorted(god_entered)
new_level_list_all = gsf.sort_dict(new_level_list_all, 1)  # –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π
new_level_list_worthy = gsf.sort_dict(new_level_list_worthy, 0)  # –ø–æ —É—Ä–æ–≤–Ω—é
new_t_level_list = gsf.sort_dict(new_t_level_list, 0)  # –ø–æ —É—Ä–æ–≤–Ω—é
bricks_change = gsf.sort_dict(bricks_change, 1)  # –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –∫–∏—Ä–ø–∏—á–µ–π
wood_change = gsf.sort_dict(wood_change, 1)  # –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –±—Ä—ë–≤–µ–Ω
new_arks = sorted(new_arks.items())  # –ø–æ –Ω–æ–≤—ã–º –ø–∞–ª—É–±–∞–º
savings_change = gsf.sort_dict(savings_change, 1)  # –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –ø–µ–Ω—Å–∏–∏
fm_change = gsf.sort_dict(fm_change, 3)  # –ø–æ —Å—É–º–º–µ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö —Å–∞–º—Ü–æ–≤ –∏ —Å–∞–º–æ–∫
words_change = gsf.sort_dict(words_change, 1)  # –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≤–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤
fight_change = gsf.sort_dict(fight_change, 3)  # –ø–æ —Ä–∞–∑–Ω–∏—Ü–µ –ø–æ–±–µ–¥-–ø–æ—Ä–∞–∂–µ–Ω–∏–π
pet_change_level_all = gsf.sort_dict(pet_change_level_all, 1)  # –ø–æ —É—Ä–æ–≤–Ω—é –ø–∏—Ç–æ–º—Ü–∞
pet_change_level_worthy = gsf.sort_dict(pet_change_level_worthy, 1)  # –ø–æ —É—Ä–æ–≤–Ω—é –ø–∏—Ç–æ–º—Ü–∞

# —Å—ã—Ä–∞—è –∏–Ω—Ñ–∞ –ø–æ –ø–æ–∫–∞–∑—É –≤—Å–µ–≥–æ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –≤ –∫–æ–Ω—Å–æ–ª—å
show_stat = 1
if show_stat == 1:
    print('–£—à–µ–¥—à–∏–µ:\n', god_leaved)
    print('\n–ü—Ä–∏—à–µ–¥—à–∏–µ:\n', god_entered)
    print('\n–ù–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏ (–≤—Å–µ):\n', new_level_list_all)
    print('\n–ù–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏ (–∫–∞—Ä–¥–∏–Ω–∞–ª –∏ –≤—ã—à–µ):\n', new_level_list_worthy)
    print('\n–ù–æ–≤—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏:\n', new_t_level_list)
    print('\n–ù–æ–≤—ã–µ –∑–≤–∞–Ω–∏—è:\n', clan_position_change)
    print('\n–ö–∏—Ä–ø–∏—á–µ–π —Å–æ–±—Ä–∞–Ω–æ:\n', bricks_change)
    print('\n–ù–æ–≤—ã–µ —Ö—Ä–∞–º—ã:\n', new_temple)
    print('\n–ë—Ä—ë–≤–µ–Ω —Å–æ–±—Ä–∞–Ω–æ:\n', wood_change)
    print('\n–ù–æ–≤—ã–µ –∫–æ–≤—á–µ–≥–∏:\n', new_arks)
    print('\n–ü–µ–Ω—Å–∏–∏ —Å–æ–±—Ä–∞–Ω–æ:\n', savings_change)
    print('\n–ù–æ–≤—ã–µ –ª–∞–≤–æ—á–Ω–∏–∫–∏:\n', new_shop)
    print('\n–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–≤–∞—Ä—è–º:\n', fm_change)
    print('\n–ù–æ–≤–∞—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è:\n', new_lab)
    print('\n–ù–æ–≤—ã–π –±–æ—Å—Å:\n', new_bosses)
    print('\n–í–ø–∏—Å–∞–Ω–æ –Ω–æ–≤—ã—Ö —Å–ª–æ–≤ –≤ –∫–Ω–∏–≥—É:\n', words_change)
    print('\n–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –±–æ—è–º:\n', fight_change)
    print('\n–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ —É—Ä–æ–≤–Ω—è–º –ø–∏—Ç–æ–º—Ü–µ–≤ (–≤—Å–µ):\n', pet_change_level_all)
    print('\n–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ —É—Ä–æ–≤–Ω—è–º –ø–∏—Ç–æ–º—Ü–µ–≤ (–∫–∞—Ä–¥–∏–Ω–∞–ª –∏ –≤—ã—à–µ):\n', pet_change_level_worthy)
    print('\n–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –ø–∏—Ç–æ–º—Ü–µ–≤:\n', pet_change_status)

# –∑–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª –≤—Å–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ —Å—ã—Ä–æ–º –≤–∏–¥–µ (—Ñ–∞–π–ª results.txt)
write_stat_file = 1
if write_stat_file == 1:
    f = open('results.txt', 'w', encoding='utf-8')
    f.write('–£—à–µ–¥—à–∏–µ:\n' + str(god_leaved) + '\n\n')
    f.write('–ü—Ä–∏—à–µ–¥—à–∏–µ:\n' + str(god_entered) + '\n\n')
    f.write('–ù–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏ (–≤—Å–µ):\n' + str(new_level_list_all) + '\n\n')
    f.write('–ù–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏ (–∫–∞—Ä–¥–∏–Ω–∞–ª –∏ –≤—ã—à–µ):\n' + str(new_level_list_worthy) + '\n\n')
    f.write('–ù–æ–≤—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —É—Ä–æ–≤–Ω–∏:\n' + str(new_t_level_list) + '\n\n')
    f.write('–ù–æ–≤—ã–µ –∑–≤–∞–Ω–∏—è:\n' + str(clan_position_change) + '\n\n')
    f.write('–ö–∏—Ä–ø–∏—á–µ–π —Å–æ–±—Ä–∞–Ω–æ:\n' + str(bricks_change) + '\n\n')
    f.write('–ù–æ–≤—ã–µ —Ö—Ä–∞–º—ã:\n' + str(new_temple) + '\n\n')
    f.write('–ë—Ä—ë–≤–µ–Ω —Å–æ–±—Ä–∞–Ω–æ:\n' + str(wood_change) + '\n\n')
    f.write('–ù–æ–≤—ã–µ –∫–æ–≤—á–µ–≥–∏:\n' + str(new_arks) + '\n\n')
    f.write('–ü–µ–Ω—Å–∏–∏ —Å–æ–±—Ä–∞–Ω–æ:\n' + str(savings_change) + '\n\n')
    f.write('–ù–æ–≤—ã–µ –ª–∞–≤–æ—á–Ω–∏–∫–∏:\n' + str(new_shop) + '\n\n')
    f.write('–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–≤–∞—Ä—è–º:\n' + str(fm_change) + '\n\n')
    f.write('–ù–æ–≤–∞—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è:\n' + str(new_lab) + '\n\n')
    f.write('–ù–æ–≤—ã–π –±–æ—Å—Å:\n' + str(new_bosses) + '\n\n')
    f.write('–í–ø–∏—Å–∞–Ω–æ –Ω–æ–≤—ã—Ö —Å–ª–æ–≤ –≤ –∫–Ω–∏–≥—É:\n' + str(words_change) + '\n\n')
    f.write('–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –±–æ—è–º:\n' + str(fight_change) + '\n\n')
    f.write('–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ —É—Ä–æ–≤–Ω—è–º –ø–∏—Ç–æ–º—Ü–µ–≤ (–≤—Å–µ):\n' + str(pet_change_level_all) + '\n\n')
    f.write('–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ —É—Ä–æ–≤–Ω—è–º –ø–∏—Ç–æ–º—Ü–µ–≤ (–∫–∞—Ä–¥–∏–Ω–∞–ª –∏ –≤—ã—à–µ):\n' + str(pet_change_level_worthy) + '\n\n')
    f.write('–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –ø–∏—Ç–æ–º—Ü–µ–≤:\n' + str(pet_change_status))
    f.close()

# —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥–µ–∫–≤–∞—Ç–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–∞ —Ñ–æ—Ä—É–º

clan_position_change_for_text = ''  # —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –≥–∏–ª—å–¥–∑–≤–∞–Ω–∏–π
# —Å–ª–æ–≤–∞—Ä—å –∑–≤–∞–Ω–∏–π –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è —Å—Ç–∞—Ä—à–∏–Ω—Å—Ç–≤–∞
clan_positions = {'—Ñ–∞–Ω–∞—Ç': [], '—Ä–µ–∫—Ä—É—Ç': [], '—Å—Ç–∞–∂—ë—Ä': [], '–∞–¥–µ–ø—Ç': [], '–º–∞—Å—Ç–µ—Ä': [], '–º–∞–≥–∏—Å—Ç—Ä': [], '—Å–æ–≤–µ—Ç–Ω–∏–∫': [],
                  '–≥—Ä–∞–Ω–¥–º–∞—Å—Ç–µ—Ä': [], '–∫–∞—Ä–¥–∏–Ω–∞–ª': [], '–∏–µ—Ä–∞—Ä—Ö': [], '–ø–∞—Ç—Ä–∏–∞—Ä—Ö': [], '—Ä–µ–≥–µ–Ω—Ç': [], '–ø—Ä–æ—Ä–æ–∫': [],
                  '—Å–ø–µ—Ü–∑–≤–∞–Ω–∏–µ': []}
# –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ –≤ —Å–ø–∏—Å–∫–µ –±–æ–≥–æ–≤ —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Ä–∞–Ω–≥–∞
for key, value in clan_position_change.items():
    clan_positions[value].append(key)  # –¥–æ–±–∞–≤–ª—è–µ–º –±–æ–≥–∞ –≤ —Å–ª–æ–≤–∞—Ä—å –ø–æ –∑–≤–∞–Ω–∏—è–º
# –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ –≤ —Å–ª–æ–≤–∞—Ä–µ –∑–≤–∞–Ω–∏–π
for key, value in clan_positions.items():
    if len(value) > 0:  # –µ—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –±–æ–≥ –≤ –∑–≤–∞–Ω–∏–∏
        # –¥–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —Å—Ç—Ä–æ–∫–∏ (–∏–º—è –±–æ–≥–∞, –∑–≤–∞–Ω–∏–µ)
        clan_position_change_for_text += f'* {key} {len(value)}: {", ".join(value)}\n'

pet_change_lvl_for_text = ''  # —Å—Ç—Ä–æ–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—è–º –ø–∏—Ç–æ–º—Ü–µ–≤
# –¥–ª—è –∫–∞–∂–¥–æ–≥–æ, –∫—Ç–æ —Å—Ç–∞—Ä—à–µ –∫–∞—Ä–¥–∏–Ω–∞–ª–∞
for key in pet_change_level_worthy.keys():
    # –¥–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —Å—Ç—Ä–æ–∫–∏ (–∏–º—è –±–æ–≥–∞, –∏–º—è –ø–∏—Ç–æ–º—Ü–∞, —É—Ä–æ–≤–µ–Ω—å –ø–∏—Ç–æ–º—Ü–∞, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ —É—Ä–æ–≤–Ω–µ –ø–∏—Ç–æ–º—Ü–∞)
    pet_change_lvl_for_text += f'{key}: ' \
                               f'{pet_change_level_worthy[key][0]}: ' \
                               f'{pet_change_level_worthy[key][1]} ' \
                               f'({pet_change_level_worthy[key][2]}); '

pet_change_status_for_text = ''  # —Å—Ç—Ä–æ–∫–∞ –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–∏—Ç–æ–º—Ü–µ–≤
# –¥–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ—É –ø–æ –≥–µ—Ä–æ—è–º, –æ—Å—Ç–∞–≤—à–∏–º—Å—è –±–µ–∑ –ø–∏—Ç–æ–º—Ü–∞ (–µ—Å–ª–∏ —Ç–∞–∫–∏–µ –µ—Å—Ç—å)
if len(pet_change_status['–ì–µ—Ä–æ–π –æ—Å—Ç–∞–ª—Å—è –±–µ–∑ –ø–∏—Ç–æ–º—Ü–∞']) > 0:
    pet_change_status_for_text += ' * –ì–µ—Ä–æ–π –æ—Å—Ç–∞–ª—Å—è –±–µ–∑ –ø–∏—Ç–æ–º—Ü–∞: '
    for value in pet_change_status['–ì–µ—Ä–æ–π –æ—Å—Ç–∞–ª—Å—è –±–µ–∑ –ø–∏—Ç–æ–º—Ü–∞']:
        pet_change_status_for_text += f'{value}, '
    pet_change_status_for_text = pet_change_status_for_text[:-2]
# –¥–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ—É –ø–æ –≥–µ—Ä–æ—è–º, —á–µ–π –ø–∏—Ç–æ–º–µ—Ü –æ—Å—Ç–∞–ª—Å—è –±–µ–∑ —É—Ä–æ–≤–Ω—è (–µ—Å–ª–∏ —Ç–∞–∫–∏–µ –µ—Å—Ç—å)
if len(pet_change_status['–ü–∏—Ç–æ–º–µ—Ü –≥–µ—Ä–æ—è –æ—Å—Ç–∞–ª—Å—è –±–µ–∑ —É—Ä–æ–≤–Ω—è']) > 0:
    pet_change_status_for_text += '\n * –ü–∏—Ç–æ–º–µ—Ü –ø–æ—Ç–µ—Ä—è–ª —É—Ä–æ–≤–µ–Ω—å: '
    for value in pet_change_status['–ü–∏—Ç–æ–º–µ—Ü –≥–µ—Ä–æ—è –æ—Å—Ç–∞–ª—Å—è –±–µ–∑ —É—Ä–æ–≤–Ω—è']:
        pet_change_status_for_text += f'{value}, '
    pet_change_status_for_text = pet_change_status_for_text[:-2]
# –¥–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ—É –ø–æ –≥–µ—Ä–æ—è–º, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–µ–ª–∏ –Ω–æ–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞ (–µ—Å–ª–∏ —Ç–∞–∫–∏–µ –µ—Å—Ç—å)
if len(pet_change_status['–ì–µ—Ä–æ–π –∑–∞–≤—ë–ª –Ω–æ–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞']) > 0:
    pet_change_status_for_text += '\n * –ì–µ—Ä–æ–π –∑–∞–≤—ë–ª –Ω–æ–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞: '
    for value in pet_change_status['–ì–µ—Ä–æ–π –∑–∞–≤—ë–ª –Ω–æ–≤–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞']:
        pet_change_status_for_text += f'{value[0]} ({value[1]}), '
    pet_change_status_for_text = pet_change_status_for_text[:-2]
pet_change_status_for_text += '\n'

bricks_change_for_text = ''  # —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –∫–∏—Ä–ø–∏—á–µ—Å–±–æ—Ä—â–∏–∫–æ–≤
bricks_list, i, counter = [], 0, 1
bricks_list_for_places = {'1 –º–µ—Å—Ç–æ:': [], '2 –º–µ—Å—Ç–æ:': [], '3 –º–µ—Å—Ç–æ:': []}
# –¥–ª—è –≤—Å–µ—Ö –≤ —Å–ø–∏—Å–∫–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ –∫–æ–ª-–≤—É —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –∫–∏—Ä–ø–∏—á–µ–π
for key in bricks_change.keys():
    # —Ä–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ —Å–ª–æ–≤–∞ –∏ –≤–Ω–æ—Å–∏–º –≤ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ (–∏–º—è –±–æ–≥–∞, —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –∫–∏—Ä–ø–∏—á–µ–π, –≤—Å–µ–≥–æ –∫–∏—Ä–ø–∏—á–µ–π)
    bricks_list.append(f'{key}: '
                       f'{bricks_change[key][1]} '
                       f'({bricks_change[key][0]} –≤—Å–µ–≥–æ);'.split(' '))
# —Å—Ç–∞–≤–∏–º –ø–µ—Ä–≤–æ–≥–æ –≤ —Å–ø–∏—Å–∫–µ –Ω–∞ –ø–µ—Ä–≤–æ–µ –º–µ—Å—Ç–æ
bricks_list_for_places['1 –º–µ—Å—Ç–æ:'].append(bricks_list[0])
# –ø–æ–∫–∞ —Å–ø–∏—Å–æ–∫ –Ω–µ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è
while i < len(bricks_list) - 1:
    # –µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –∫–∏—Ä–ø–∏—á–µ–π —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–æ–≥–∞ —Ä–∞–≤–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É
    if bricks_list[i][-3] == bricks_list[i + 1][-3]:
        # –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ —Ç–æ –∂–µ —Å–∞–º–æ–µ –º–µ—Å—Ç–æ
        bricks_list_for_places[f'{counter} –º–µ—Å—Ç–æ:'].append(bricks_list[i + 1])
    # –µ—Å–ª–∏ –Ω–µ—Ç, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –º–µ—Å—Ç
    else:
        counter += 1
        # –µ—Å–ª–∏ –≤–Ω–µ—Å–ª–∏ –≤—Å–µ—Ö –≤ —Ç–æ–ø-3
        if counter == 4:
            # –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞ –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏
            break
        # –µ—Å–ª–∏ —Ç–æ–ø-3 –µ—â—ë –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω
        else:
            # –≤–Ω–æ—Å–∏–º –±–æ–≥–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–µ –º–µ—Å—Ç–æ
            bricks_list_for_places[f'{counter} –º–µ—Å—Ç–æ:'].append(bricks_list[i + 1])
    i += 1
# –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—Ç–∞
for key, value in bricks_list_for_places.items():
    # —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫ –≤–º–µ—Å—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö
    bricks_list_for_places[key] = list(gsf.list_flatten(value))
    # —Å–æ–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫—É
    bricks_change_for_text += f'{key} {" ".join(bricks_list_for_places[key])[:-1]}\n'

wood_change_for_text = ''  # —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –±—Ä–µ–≤–Ω–æ—Å–±–æ—Ä—â–∏–∫–æ–≤
wood_list, i, counter = [], 0, 1
wood_list_for_places = {'1 –º–µ—Å—Ç–æ:': [], '2 –º–µ—Å—Ç–æ:': [], '3 –º–µ—Å—Ç–æ:': []}
# –¥–ª—è –≤—Å–µ—Ö –≤ —Å–ø–∏—Å–∫–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ –∫–æ–ª-–≤—É —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –±—Ä—ë–≤–µ–Ω
for key in wood_change.keys():
    # —Ä–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ —Å–ª–æ–≤–∞ –∏ –≤–Ω–æ—Å–∏–º –≤ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ (–∏–º—è –±–æ–≥–∞, —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –±—Ä—ë–≤–µ–Ω, –≤—Å–µ–≥–æ –±—Ä—ë–≤–µ–Ω)
    wood_list.append(f'{key}: '
                     f'{wood_change[key][1]} '
                     f'({wood_change[key][0]} –≤—Å–µ–≥–æ);'.split(' '))
# —Å—Ç–∞–≤–∏–º –ø–µ—Ä–≤–æ–≥–æ –≤ —Å–ø–∏—Å–∫–µ –Ω–∞ –ø–µ—Ä–≤–æ–µ –º–µ—Å—Ç–æ
wood_list_for_places['1 –º–µ—Å—Ç–æ:'].append(wood_list[0])
# –ø–æ–∫–∞ —Å–ø–∏—Å–æ–∫ –Ω–µ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è
while i < len(wood_list) - 1:
    # –µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –±—Ä—ë–≤–µ–Ω —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–æ–≥–∞ —Ä–∞–≤–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É
    if wood_list[i][-3] == wood_list[i + 1][-3]:
        # –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ —Ç–æ –∂–µ —Å–∞–º–æ–µ –º–µ—Å—Ç–æ
        wood_list_for_places[f'{counter} –º–µ—Å—Ç–æ:'].append(wood_list[i + 1])
    # –µ—Å–ª–∏ –Ω–µ—Ç, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –º–µ—Å—Ç
    else:
        counter += 1
        # –µ—Å–ª–∏ –≤–Ω–µ—Å–ª–∏ –≤—Å–µ—Ö –≤ —Ç–æ–ø-3
        if counter == 4:
            # –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞ –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏
            break
        # –µ—Å–ª–∏ —Ç–æ–ø-3 –µ—â—ë –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω
        else:
            # –≤–Ω–æ—Å–∏–º –±–æ–≥–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–µ –º–µ—Å—Ç–æ
            wood_list_for_places[f'{counter} –º–µ—Å—Ç–æ:'].append(wood_list[i + 1])
    i += 1
# –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—Ç–∞
for key, value in wood_list_for_places.items():
    # —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫ –≤–º–µ—Å—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö
    wood_list_for_places[key] = list(gsf.list_flatten(value))
    # —Å–æ–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫—É
    wood_change_for_text += f'{key} {" ".join(wood_list_for_places[key])[:-1]}\n'

new_arks_for_text = ''  # —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–æ–≤—á–µ–≥–æ–≤
# –¥–ª—è –≤—Å–µ—Ö –≤ —Å–ø–∏—Å–∫–µ —Å–æ–±—Ä–∞–≤—à–∏—Ö –Ω–æ–≤—ã–µ –ø–∞–ª—É–±—ã
for i in new_arks:
    # —Å–æ–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫—É (–Ω–æ–º–µ—Ä –Ω–æ–≤–æ–π –ø–∞–ª—É–±—ã, –∏–º–µ–Ω–∞ –±–æ–≥–æ–≤)
    new_arks_for_text += f'{i[0]}: {", ".join(i[1])} \n'

fm_change_for_text = ''  # —Å—Ç—Ä–æ–∫–∞ –¥–ª—è —Ç–≤–∞—Ä–µ—Å–±–æ—Ä—â–∏–∫–æ–≤
fm_list, i, counter = [], 0, 1
fm_list_for_places = {'1 –º–µ—Å—Ç–æ:': [], '2 –º–µ—Å—Ç–æ:': [], '3 –º–µ—Å—Ç–æ:': []}
# –¥–ª—è –≤—Å–µ—Ö –≤ —Å–ø–∏—Å–∫–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ –∫–æ–ª-–≤—É —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö —Ç–≤–∞—Ä–µ–π
for key in fm_change.keys():
    # —Ä–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ —Å–ª–æ–≤–∞ –∏ –≤–Ω–æ—Å–∏–º –≤ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ (–∏–º—è –±–æ–≥–∞, –≤—Å–µ–≥–æ —Ç–≤–∞—Ä–µ–π, +—Å–∞–º—Ü–æ–≤, + —Å–∞–º–æ–∫, —Å—É–º–º–∞)
    fm_list.append(f'{key}: {fm_change[key][3]} ({fm_change[key][1]}‚ôÇ '
                   f'({fm_change[key][0][:fm_change[key][0].find("–º")]} –≤—Å–µ–≥–æ) / '
                   f'{fm_change[key][2]}‚ôÄ '
                   f'({fm_change[key][0][fm_change[key][0].find("/") + 1:-1]} –≤—Å–µ–≥–æ));'.split(' '))
# —Å—Ç–∞–≤–∏–º –ø–µ—Ä–≤–æ–≥–æ –≤ —Å–ø–∏—Å–∫–µ –Ω–∞ –ø–µ—Ä–≤–æ–µ –º–µ—Å—Ç–æ
fm_list_for_places['1 –º–µ—Å—Ç–æ:'].append(fm_list[0])
# –ø–æ–∫–∞ —Å–ø–∏—Å–æ–∫ –Ω–µ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è
while i < len(fm_list) - 1:
    # –µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö —Ç–≤–∞—Ä–µ–π —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–æ–≥–∞ —Ä–∞–≤–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É
    if fm_list[i][-8] == fm_list[i + 1][-8]:
        # –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ —Ç–æ –∂–µ —Å–∞–º–æ–µ –º–µ—Å—Ç–æ
        fm_list_for_places[f'{counter} –º–µ—Å—Ç–æ:'].append(fm_list[i + 1])
    # –µ—Å–ª–∏ –Ω–µ—Ç, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –º–µ—Å—Ç
    else:
        counter += 1
        # –µ—Å–ª–∏ –≤–Ω–µ—Å–ª–∏ –≤—Å–µ—Ö –≤ —Ç–æ–ø-3
        if counter == 4:
            # –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞ –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏
            break
        # –µ—Å–ª–∏ —Ç–æ–ø-3 –µ—â—ë –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω
        else:
            # –≤–Ω–æ—Å–∏–º –±–æ–≥–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–µ –º–µ—Å—Ç–æ
            fm_list_for_places[f'{counter} –º–µ—Å—Ç–æ:'].append(fm_list[i + 1])
    i += 1
# –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—Ç–∞
for key, value in fm_list_for_places.items():
    # —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫ –≤–º–µ—Å—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö
    fm_list_for_places[key] = list(gsf.list_flatten(value))
    # —Å–æ–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫—É
    fm_change_for_text += f'{key} {" ".join(fm_list_for_places[key])[:-1]}\n'

savings_change_for_text = ''  # —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –ø–µ–Ω—Å–∏–µ—Å–±–æ—Ä—â–∏–∫–æ–≤
savings_list, i, counter = [], 0, 1
savings_list_for_places = {'1 –º–µ—Å—Ç–æ:': [], '2 –º–µ—Å—Ç–æ:': [], '3 –º–µ—Å—Ç–æ:': []}
# –¥–ª—è –≤—Å–µ—Ö –≤ —Å–ø–∏—Å–∫–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ –∫–æ–ª-–≤—É –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –ø–µ–Ω—Å–∏–∏
for key in savings_change.keys():
    # —Ä–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ —Å–ª–æ–≤–∞ –∏ –≤–Ω–æ—Å–∏–º –≤ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ (–∏–º—è –±–æ–≥–∞, –≤—Å–µ–≥–æ –ø–µ–Ω—Å–∏–∏, —Å–æ–±—Ä–∞–Ω–æ –ø–µ–Ω—Å–∏–∏)
    savings_list.append(f'{key}: '
                        f'{savings_change[key][1]} '
                        f'({savings_change[key][0][:savings_change[key][0].find(" ")]} –≤—Å–µ–≥–æ);'.split(' '))
# —Å—Ç–∞–≤–∏–º –ø–µ—Ä–≤–æ–≥–æ –≤ —Å–ø–∏—Å–∫–µ –Ω–∞ –ø–µ—Ä–≤–æ–µ –º–µ—Å—Ç–æ
savings_list_for_places['1 –º–µ—Å—Ç–æ:'].append(savings_list[0])
# –ø–æ–∫–∞ —Å–ø–∏—Å–æ–∫ –Ω–µ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è
while i < len(savings_list) - 1:
    # –µ—Å–ª–∏ —É —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–æ–≥–∞ –æ—Ç–ª–æ–∂–µ–Ω–æ —Å—Ç–æ–ª—å–∫–æ –∂–µ –ø–µ–Ω—Å–∏–∏, —Å–∫–æ–ª—å–∫–æ –∏ —É –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ
    if savings_list[i][-3] == savings_list[i + 1][-3]:
        # –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ —Ç–æ –∂–µ —Å–∞–º–æ–µ –º–µ—Å—Ç–æ
        savings_list_for_places[f'{counter} –º–µ—Å—Ç–æ:'].append(savings_list[i + 1])
    # –µ—Å–ª–∏ –Ω–µ—Ç, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –º–µ—Å—Ç
    else:
        counter += 1
        # –µ—Å–ª–∏ –≤–Ω–µ—Å–ª–∏ –≤—Å–µ—Ö –≤ —Ç–æ–ø-3
        if counter == 4:
            # –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞ –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏
            break
        # –µ—Å–ª–∏ —Ç–æ–ø-3 –µ—â—ë –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω
        else:
            # –≤–Ω–æ—Å–∏–º –±–æ–≥–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–µ –º–µ—Å—Ç–æ
            savings_list_for_places[f'{counter} –º–µ—Å—Ç–æ:'].append(savings_list[i + 1])
    i += 1
# –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—Ç–∞
for key, value in savings_list_for_places.items():
    # —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫ –≤–º–µ—Å—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö
    savings_list_for_places[key] = list(gsf.list_flatten(value))
    # —Å–æ–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫—É
    savings_change_for_text += f'{key} {" ".join(savings_list_for_places[key])[:-1]}\n'

words_change_for_text = ''  # —Å—Ç—Ä–æ–∫–∞ –¥–ª—è —Å–ª–æ–≤–æ—Å–±–æ—Ä—â–∏–∫–æ–≤
words_list, i, counter = [], 0, 1
words_list_for_places = {'1 –º–µ—Å—Ç–æ:': [], '2 –º–µ—Å—Ç–æ:': [], '3 –º–µ—Å—Ç–æ:': []}
# –¥–ª—è –≤—Å–µ—Ö –≤ —Å–ø–∏—Å–∫–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ –∫–æ–ª-–≤—É —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤
for key in words_change.keys():
    # —Ä–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ —Å–ª–æ–≤–∞ –∏ –≤–Ω–æ—Å–∏–º –≤ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ (–∏–º—è –±–æ–≥–∞, –≤—Å–µ–≥–æ —Å–ª–æ–≤, —Å–æ–±—Ä–∞–Ω–æ —Å–ª–æ–≤)
    words_list.append(f'{key}: '
                      f'{words_change[key][1]} '
                      f'({words_change[key][0]} –≤—Å–µ–≥–æ);'.split(' '))
# —Å—Ç–∞–≤–∏–º –ø–µ—Ä–≤–æ–≥–æ –≤ —Å–ø–∏—Å–∫–µ –Ω–∞ –ø–µ—Ä–≤–æ–µ –º–µ—Å—Ç–æ
words_list_for_places['1 –º–µ—Å—Ç–æ:'].append(words_list[0])
# –ø–æ–∫–∞ —Å–ø–∏—Å–æ–∫ –Ω–µ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è
while i < len(words_list) - 1:
    # –µ—Å–ª–∏ —É —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–æ–≥–∞ —Å–æ–±—Ä–∞–Ω–æ —Å—Ç–æ–ª—å–∫–æ –∂–µ —Å–ª–æ–≤, —Å–∫–æ–ª—å–∫–æ –∏ —É –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ
    if words_list[i][-3] == words_list[i + 1][-3]:
        # –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ —Ç–æ –∂–µ —Å–∞–º–æ–µ –º–µ—Å—Ç–æ
        words_list_for_places[f'{counter} –º–µ—Å—Ç–æ:'].append(words_list[i + 1])
    # –µ—Å–ª–∏ –Ω–µ—Ç, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –º–µ—Å—Ç
    else:
        counter += 1
        # –µ—Å–ª–∏ –≤–Ω–µ—Å–ª–∏ –≤—Å–µ—Ö –≤ —Ç–æ–ø-3
        if counter == 4:
            # –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞ –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏
            break
        # –µ—Å–ª–∏ —Ç–æ–ø-3 –µ—â—ë –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω
        else:
            # –≤–Ω–æ—Å–∏–º –±–æ–≥–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–µ –º–µ—Å—Ç–æ
            words_list_for_places[f'{counter} –º–µ—Å—Ç–æ:'].append(words_list[i + 1])
    i += 1
# –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—Ç–∞
for key, value in words_list_for_places.items():
    # —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫ –≤–º–µ—Å—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö
    words_list_for_places[key] = list(gsf.list_flatten(value))
    # —Å–æ–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫—É
    words_change_for_text += f'{key} {" ".join(words_list_for_places[key])[:-1]}\n'

fight_change_for_text = ''  # —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –∞—Ä–µ–Ω–æ—Å–±–æ—Ä—â–∏–∫–æ–≤
fight_list, i, counter = [], 0, 1
fight_list_for_places = {'1 –º–µ—Å—Ç–æ:': [], '2 –º–µ—Å—Ç–æ:': [], '3 –º–µ—Å—Ç–æ:': []}
# –¥–ª—è –≤—Å–µ—Ö –≤ —Å–ø–∏—Å–∫–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ –∫–æ–ª-–≤—É –≤—ã–∏–≥—Ä–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ–∏–≥—Ä–∞–Ω–Ω—ã—Ö –∞—Ä–µ–Ω
for key in fight_change.keys():
    # —Ä–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ —Å–ª–æ–≤–∞ –∏ –≤–Ω–æ—Å–∏–º –≤ —Å–ø–∏—Å–æ–∫ —Å–ø–∏—Å–∫–æ–≤ (–∏–º—è –±–æ–≥–∞, –≤—Å–µ–≥–æ –∞—Ä–µ–Ω, +–ø–æ–±–µ–¥, +–ø–æ—Ä–∞–∂–µ–Ω–∏–π, —Ä–∞–∑–Ω–∏—Ü–∞)
    fight_list.append(f'{key}: '
                      f'{fight_change[key][3]} '
                      f'({fight_change[key][1]} üèÜ '
                      f'({fight_change[key][0][:fight_change[key][0].find(" ")]} –≤—Å–µ–≥–æ) / '
                      f'{fight_change[key][2]} ‚ò†Ô∏è '
                      f'({fight_change[key][0][fight_change[key][0].find("/") + 1:-10]} –≤—Å–µ–≥–æ));'.split(' '))
# —Å—Ç–∞–≤–∏–º –ø–µ—Ä–≤–æ–≥–æ –≤ —Å–ø–∏—Å–∫–µ –Ω–∞ –ø–µ—Ä–≤–æ–µ –º–µ—Å—Ç–æ
fight_list_for_places['1 –º–µ—Å—Ç–æ:'].append(fight_list[0])
# –ø–æ–∫–∞ —Å–ø–∏—Å–æ–∫ –Ω–µ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è
while i < len(fight_list) - 1:
    # –µ—Å–ª–∏ —É —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–æ–≥–∞ —Ç–∞–∫–∞—è –∂–µ —Ä–∞–∑–Ω–∏—Ü–∞ –ø–æ–±–µ–¥ –∏ –ø–æ—Ä–∞–∂–µ–Ω–∏–π, —Å–∫–æ–ª—å–∫–æ –∏ —É –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ
    if fight_list[i][-10] == fight_list[i + 1][-10]:
        # –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –Ω–∞ —Ç–æ –∂–µ —Å–∞–º–æ–µ –º–µ—Å—Ç–æ
        fight_list_for_places[f'{counter} –º–µ—Å—Ç–æ:'].append(fight_list[i + 1])
    # –µ—Å–ª–∏ –Ω–µ—Ç, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫ –º–µ—Å—Ç
    else:
        counter += 1
        # –µ—Å–ª–∏ –≤–Ω–µ—Å–ª–∏ –≤—Å–µ—Ö –≤ —Ç–æ–ø-3
        if counter == 4:
            # –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ü–∏–∫–ª–∞ –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏
            break
        # –µ—Å–ª–∏ —Ç–æ–ø-3 –µ—â—ë –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω
        else:
            # –≤–Ω–æ—Å–∏–º –±–æ–≥–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–µ –º–µ—Å—Ç–æ
            fight_list_for_places[f'{counter} –º–µ—Å—Ç–æ:'].append(fight_list[i + 1])
    i += 1
# –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—Ç–∞
for key, value in fight_list_for_places.items():
    # —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫ –≤–º–µ—Å—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö
    fight_list_for_places[key] = list(gsf.list_flatten(value))
    # —Å–æ–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫—É
    fight_change_for_text += f'{key} {" ".join(fight_list_for_places[key])[:-1]}\n'

new_boss_for_text = ''  # —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –±–æ—Å—Å–æ–≤
# –¥–ª—è –≤—Å–µ—Ö –≤ —Å–ø–∏—Å–∫–µ —Å–æ–±—Ä–∞–≤—à–∏—Ö –Ω–æ–≤–æ–≥–æ –±–æ—Å—Å–∞
for key, value in new_bosses.items():
    # —Å–æ–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫—É (–∏–º—è –±–æ–≥–∞, –∏–º—è –±–æ—Å—Å–∞, –º–æ—â—å –±–æ—Å—Å–∞ –≤ %)
    new_boss_for_text += f'{key}: ' \
                         f'{value[0]} ' \
                         f'–º–æ—â—å—é –≤ {value[1]}%\n'

# —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—â–µ–π —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Ñ–æ—Ä—É–º
write_forum_file = 1
if write_forum_file == 1:
    text = ''
    text += '"–ó–∞ —á–∞—à–∫–æ–π –≤–µ—á–µ—Ä–Ω–µ–≥–æ —á–∞—è":https://d.radikal.ru/d14/2004/7b/2fd6bd48f5e3.png\n\n' \
            '–¶—Ç. *–ß–µ—à–∏—Ä—Å–∫–∏–µ —á–∏—Å–µ–ª–∫–∏*\n\n'
    if len(god_leaved) > 0:
        text += f'üì§ *–£—à–ª–∏ –∏–∑ –≥–∏–ª—å–¥–∏–∏* - {len(god_leaved)} –±–æ–≥–æ–≤:\n{", ".join(god_leaved)}\n\n'
    if len(god_entered) > 0:
        text += f'üì• *–ü—Ä–∏—à–ª–∏ –≤ –≥–∏–ª—å–¥–∏—é* - {len(god_entered)} –±–æ–≥–æ–≤:\n{", ".join(god_entered)}\n\n'
    if len(clan_position_change) > 0:
        text += f'üëë *–ë–æ–≥–∏ –¥–æ—Å—Ç–∏–≥–ª–∏ –∑–≤–∞–Ω–∏–π:* \n{clan_position_change_for_text}\n'
    if len(new_level_list_worthy) > 0:
        nll = "; ".join("".join((k, ": ", str(v[0]), " (", str(v[1]), ")")) for k, v in new_level_list_worthy.items())
        text += f'üîù *–ì–µ—Ä–æ–∏ –¥–æ—Å—Ç–∏–≥–ª–∏ —É—Ä–æ–≤–Ω–µ–π* (–∫–∞—Ä–¥–∏–Ω–∞–ª –∏ –≤—ã—à–µ):\n{nll}\n\n'
    if len(new_t_level_list) > 0:
        ntll = "; ".join("".join((k, ": ", str(v[0]), " (", str(v[1]), ")")) for k, v in new_t_level_list.items())
        text += f'üìà *–ì–µ—Ä–æ–∏ –¥–æ—Å—Ç–∏–≥–ª–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö —É—Ä–æ–≤–Ω–µ–π:*\n{ntll}\n\n'
    if len(pet_change_level_worthy) > 0:
        text += f'üêæ *–ü–∏—Ç–æ–º—Ü—ã –¥–æ—Å—Ç–∏–≥–ª–∏ —É—Ä–æ–≤–Ω–µ–π* (–∫–∞—Ä–¥–∏–Ω–∞–ª –∏ –≤—ã—à–µ):\n{pet_change_lvl_for_text}\n\n'
    if len(pet_change_status) > 0:
        text += f'üëÄ *–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –ø–∏—Ç–æ–º—Ü–µ–≤*:\n{pet_change_status_for_text}\n'
    if len(new_temple) > 0:
        text += f'‚õ™ *–ü–æ—Å—Ç—Ä–æ–µ–Ω–æ —Ö—Ä–∞–º–æ–≤:*\n{", ".join(new_temple)}\n\n'
    if len(new_arks) > 0:
        text += f'üõ∂ *–ü–æ—Å—Ç—Ä–æ–µ–Ω–æ –∫–æ–≤—á–µ–≥–æ–≤ (–ø–∞–ª—É–±):*\n{new_arks_for_text}\n\n'
    if len(new_lab) > 0:
        text += f'üî¨ *–ü–æ—Å—Ç—Ä–æ–µ–Ω–æ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–π:*\n{", ".join(new_lab)}\n\n'
    if len(new_bosses) > 0:
        text += f'üëæ *–°–æ–±—Ä–∞–Ω–æ –Ω–æ–≤—ã—Ö –±–æ—Å—Å–æ–≤:*\n{new_boss_for_text}\n\n'
    if len(new_shop) > 0:
        text += f'‚öñ *–ü–æ—Å—Ç—Ä–æ–µ–Ω–æ –ª–∞–≤–æ–∫:*\n{", ".join(new_shop)}\n\n'
    if len(bricks_change) > 0:
        text += f'‚õî *–°–æ–±—Ä–∞–Ω–æ –∫–∏—Ä–ø–∏—á–µ–π:*\n{bricks_change_for_text}\n'
    if len(wood_change) > 0:
        text += f'üå≥ *–°–æ–±—Ä–∞–Ω–æ –±—Ä—ë–≤–µ–Ω:*\n{wood_change_for_text}\n'
    if len(fm_change) > 0:
        text += f'‚ôÄÔ∏è‚ôÇÔ∏è *–°–æ–±—Ä–∞–Ω–æ —Ç–≤–∞—Ä–µ–π* (—Å–∞–º—Ü—ã –ø–ª—é—Å —Å–∞–º–∫–∏):\n{fm_change_for_text}\n'
    if len(savings_change) > 0:
        text += f'üí∞ *–°–æ–±—Ä–∞–Ω–æ —Å–±–µ—Ä–µ–∂–µ–Ω–∏–π* (—Ç—ã—Å—è—á):\n{savings_change_for_text}\n'
    if len(words_change) > 0:
        text += f'üìñ *–°–æ–±—Ä–∞–Ω–æ —Å–ª–æ–≤ –≤ –∫–Ω–∏–≥–∞—Ö*:\n{words_change_for_text}\n'
    if len(fight_change) > 0:
        text += f'‚öî *–î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ –∞—Ä–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–≤–µ—Å–æ–≤* (–ø–æ–±–µ–¥—ã –º–∏–Ω—É—Å –ø–æ—Ä–∞–∂–µ–Ω–∏—è):\n{fight_change_for_text}'
    text += '\n–í—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ "—Å—Å—ã–ª–∫–µ":https://drive.google.com/open?id=1-vWZTAmWmW3oPVU-qHhk_5Xk5lAiXEFk'
    f = open('results_text.txt', 'w', encoding='utf-8')
    f.write(text)
    f.close()
